<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠ ‡∏°.3/1</title>
    <link rel="stylesheet" href="class.css">
    <link href="https://fonts.googleapis.com/css2?family=Prompt&display=swap" rel="stylesheet">
</head>
<body>

<div class="container">
    <div class="header">
        <h2>üè´ ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏™‡∏≤‡∏ò‡∏á‡∏ä‡∏±‡πâ‡∏ô ‡∏°.3/1</h2>
    </div>

    <div class="controls-top">
        <input type="text" id="searchInput" placeholder="üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô...">
        <a href="index.html" class="button back-button">‚ùÆ ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</a>
        <button onclick="checkAllPresentAndSave()" class="button check-all-button">‚úÖ ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
    </div>

    <div class="table-responsive">
        <table id="attendanceTable">
            <thead>
                <tr>
                    <th>‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                    <th>‡∏ä‡∏∑‡πà‡∏≠ - ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                </tr>
            </thead>
            <tbody>
                <tr data-student-id="1">
                    <td>1</td>
                    <td>
                        <div>‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢ ‡∏ò‡∏µ‡∏£‡∏†‡∏±‡∏ó‡∏£ ‡πÇ‡∏Å‡∏ô‡∏û‡∏¥‡∏°‡∏≤‡∏¢</div>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ </div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="2">
                    <td>2</td>
                    <td>
                        <div>‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢ ‡∏õ‡∏è‡∏¥‡∏°‡∏≤‡∏Å‡∏£‡∏ì‡πå ‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå‡∏™‡∏£‡∏∞‡∏Ñ‡∏π</div>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ </div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="3">
                    <td>3</td>
                    <td>
                        <div>‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢ ‡∏û‡∏ô‡∏°‡∏û‡∏£ ‡∏°‡∏∏‡πà‡∏á‡∏•‡∏≠‡∏¢‡∏Å‡∏•‡∏≤‡∏á</div>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ </div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="4">
                    <td>4</td>
                    <td>
                        <div>‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢ ‡∏Å‡∏¥‡∏ï‡∏ï‡∏¥‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå ‡∏ß‡∏á‡∏©‡πå‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå</div>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ </div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="5">
                    <td>5</td>
                    <td>
                        <div>‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢ ‡∏≠‡∏ô‡∏∏‡∏£‡∏±‡∏Å‡∏©‡πå ‡∏ô‡∏≤‡∏Ñ‡∏™‡∏µ‡∏™‡∏î</div>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ </div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="6">
                    <td>6</td>
                    <td>
                        <div>‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢ ‡∏ò‡∏ô‡∏î‡∏• ‡∏ö‡∏∏‡∏ç‡∏´‡∏ô‡∏∏‡∏ô</div>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ </div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="7">
                    <td>7</td>
                    <td>
                        <div>‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢ ‡∏™‡∏∏‡∏£‡∏ß‡∏±‡∏® ‡πÅ‡∏Å‡πâ‡∏ß‡πÅ‡∏™‡∏á‡πÉ‡∏™</div>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ </div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="8">
                    <td>8</td>
                    <td>
                        <div>‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢ ‡∏à‡∏±‡∏Å‡∏£‡∏§‡∏ó‡∏ò‡∏¥‡πå ‡∏Ñ‡∏≥‡πÄ‡∏™‡∏µ‡∏¢‡∏á</div>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ </div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="9">
                    <td>9</td>
                    <td>
                        <div>‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢ ‡∏ò‡∏µ‡∏ò‡∏±‡∏ä ‡πÄ‡∏™‡∏ñ‡∏≤</div>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ </div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="10">
                    <td>10</td>
                    <td>
                        <div>‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢ ‡∏®‡∏∏‡∏†‡∏Å‡∏£ ‡∏™‡∏¥‡∏á‡∏Ç‡∏£</div>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ </div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="11">
                    <td>11</td>
                    <td>
                        <div>‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢ ‡∏≠‡∏†‡∏¥‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå ‡∏≠‡∏¥‡∏™‡∏°‡∏≤‡πÅ‡∏≠‡∏ô</div>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ </div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="12">
                    <td>12</td>
                    <td>
                        <div>‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á ‡∏™‡∏∏‡∏ä‡∏±‡∏ç‡∏ç‡∏≤ ‡∏≠‡∏±‡∏î‡∏ó‡∏ß‡∏µ‡∏Ñ‡∏π‡∏ì</div>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ </div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="13">
                    <td>13</td>
                    <td>
                        <div>‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á ‡∏®‡∏®‡∏¥‡∏ß‡∏¥‡∏°‡∏• ‡πÅ‡∏ß‡∏î‡∏™‡∏µ</div>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ </div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="14">
                    <td>14</td>
                    <td>
                        <div>‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á ‡∏ä‡∏•‡∏•‡∏î‡∏≤ ‡πÄ‡∏®‡∏µ‡∏¢‡∏£‡∏ô‡∏≠‡∏Å</div>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ </div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="15">
                    <td>15</td>
                    <td>
                        <div>‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á ‡∏õ‡∏ß‡∏±‡∏ô‡∏£‡∏±‡∏ï‡∏ô‡πå ‡πÄ‡∏Å‡∏¥‡∏î‡πÅ‡∏û‡∏£</div>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ </div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="16">
                    <td>16</td>
                    <td>
                        <div>‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á ‡∏ò‡∏°‡∏•‡∏ß‡∏£‡∏£‡∏ì ‡∏≠‡∏∏‡πà‡∏ô‡∏ß‡∏¥‡πÄ‡∏ä‡∏µ‡∏¢‡∏£</div>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ </div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="17">
                    <td>17</td>
                    <td>
                        <div>‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á ‡∏†‡∏±‡∏ó‡∏£‡∏≤‡∏ô‡∏¥‡∏©‡∏ê‡πå ‡∏™‡∏≤‡∏¢‡∏ó‡∏≠‡∏á</div>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ </div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="18">
                    <td>18</td>
                    <td>
                        <div>‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á ‡∏™‡∏∏‡∏ì‡∏±‡∏ê‡∏û‡∏£ ‡∏Å‡∏≠‡∏á‡∏≠‡∏≤‡∏™‡∏≤</div>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ </div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="19">
                    <td>19</td>
                    <td>
                        <div>‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á ‡∏û‡∏¥‡∏ó‡∏¢‡∏≤‡∏†‡∏£‡∏ì‡πå ‡∏≠‡∏¥‡∏ô‡∏≠‡πà‡∏≠‡∏ô</div>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ </div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="20">
                    <td>20</td>
                    <td>
                        <div>‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á ‡∏™‡∏∏‡∏ß‡∏¥‡∏ä‡∏≤‡∏î‡∏≤ ‡∏û‡∏±‡∏™‡∏Å‡∏≤</div>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ </div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="21">
                    <td>21</td>
                    <td>
                        <div>‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á ‡∏ô‡∏¥‡∏•‡∏õ‡∏±‡∏î ‡∏à‡∏á‡∏£‡∏ß‡∏¢‡∏Å‡∏•‡∏≤‡∏á</div>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ </div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="22">
                    <td>22</td>
                    <td>
                        <div>‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á ‡∏Å‡∏ô‡∏Å‡∏ß‡∏£‡∏£‡∏ì ‡∏ä‡πà‡∏≠‡πÄ‡∏Å‡∏©‡∏°</div>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ </div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="23">
                    <td>23</td>
                    <td>
                        <div>‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á ‡∏ì‡∏±‡∏ê‡∏ä‡∏≤ ‡∏ö‡∏∏‡∏ç‡πÄ‡∏ß‡∏ä</div>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ </div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="24">
                    <td>24</td>
                    <td>
                        <div>‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á ‡∏Å‡∏∏‡∏•‡∏õ‡∏£‡∏¥‡∏¢‡∏≤ ‡πÅ‡∏õ‡πâ‡∏ô‡πÇ‡∏û‡∏ò‡∏¥‡πå</div>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ </div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="25">
                    <td>25</td>
                    <td>
                        <div>‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á ‡∏ö‡∏∏‡∏ç‡∏ç‡∏≤‡∏û‡∏£ ‡∏û‡∏¥‡∏ô‡∏¥‡∏à‡∏ô‡∏≠‡∏Å</div>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ </div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="26">
                    <td>26</td>
                    <td>
                        <div>‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á ‡∏ß‡∏£‡∏±‡∏ç‡∏ç‡∏≤ ‡∏û‡∏¥‡∏ô‡∏¥‡∏à‡∏ô‡∏≠‡∏Å</div>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ </div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞</div>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="controls-bottom">
        
        <button onclick="saveToGoogleSheet()" class="button google-sheet-button">üì§ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
         <button onclick="exportTableToExcel()" class="button excel-button">üìÑExcel</button>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const rows = document.querySelectorAll("#attendanceTable tbody tr");
        rows.forEach(row => {
            const studentId = row.dataset.studentId;
            const statusButtons = row.querySelectorAll('.status-option');

            // ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏à‡∏≤‡∏Å localStorage
            const savedStatus = localStorage.getItem(`status_${studentId}`);
            if (savedStatus) {
                // Remove active class from any previously active buttons
                statusButtons.forEach(btn => btn.classList.remove('active', 'status-‡∏°‡∏≤', 'status-‡∏Ç‡∏≤‡∏î', 'status-‡∏•‡∏≤', 'status-‡∏°‡∏≤‡∏™‡∏≤‡∏¢'));
                
                // Add active class and color class to the saved status button
                const activeBtn = row.querySelector(`.status-option[data-status="${savedStatus}"]`);
                if (activeBtn) {
                    activeBtn.classList.add('active');
                    updateStatusButtonClass(activeBtn, savedStatus);
                }
            }

            // ‡πÄ‡∏û‡∏¥‡πà‡∏° Event Listener ‡πÉ‡∏´‡πâ‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏õ‡∏∏‡πà‡∏°
            statusButtons.forEach(button => {
                button.addEventListener('click', (event) => {
                    const currentStatus = event.target.dataset.status;
                    const currentRow = event.target.closest('tr');
                    const currentStudentId = currentRow.dataset.studentId;

                    // ‡∏•‡∏ö‡∏Ñ‡∏•‡∏≤‡∏™ 'active' ‡πÅ‡∏•‡∏∞‡∏™‡∏µ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏õ‡∏∏‡πà‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡πÅ‡∏ñ‡∏ß‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô
                    currentRow.querySelectorAll('.status-option').forEach(btn => {
                        btn.classList.remove('active', 'status-‡∏°‡∏≤', 'status-‡∏Ç‡∏≤‡∏î', 'status-‡∏•‡∏≤', 'status-‡∏°‡∏≤‡∏™‡∏≤‡∏¢');
                    });

                    // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏•‡∏≤‡∏™ 'active' ‡πÅ‡∏•‡∏∞‡∏™‡∏µ‡πÉ‡∏´‡πâ‡∏Å‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
                    event.target.classList.add('active');
                    updateStatusButtonClass(event.target, currentStatus);

                    // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏•‡∏á localStorage
                    localStorage.setItem(`status_${currentStudentId}`, currentStatus);
                });
            });
        });

        // ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÅ‡∏ö‡∏ö‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
        document.getElementById('searchInput').addEventListener('input', function() {
            const searchText = this.value.toLowerCase();
            const allRows = document.querySelectorAll("#attendanceTable tbody tr");

            allRows.forEach(row => {
                const name = row.querySelector("td:nth-child(2)").textContent.toLowerCase();
                if (name.includes(searchText)) {
                    row.style.display = "";
                } else {
                    row.style.display = "none";
                }
            });
        });

        // Event Listener ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡πÉ‡∏ô Pop-up ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
        const successModalCloseBtn = document.getElementById('successModalCloseBtn');
        if (successModalCloseBtn) {
            successModalCloseBtn.addEventListener('click', () => {
                document.getElementById('successModalOverlay').style.display = 'none';
                location.reload(); // ‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏õ‡∏¥‡∏î Pop-up
            });
        }

        // Event Listener ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡πÉ‡∏ô Pop-up ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô (NEW)
        const warningModalCloseBtn = document.getElementById('warningModalCloseBtn');
        if (warningModalCloseBtn) {
            warningModalCloseBtn.addEventListener('click', () => {
                document.getElementById('warningModalOverlay').style.display = 'none';
                // ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á reload ‡∏´‡∏ô‡πâ‡∏≤ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
            });
        }
    });

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏•‡∏≤‡∏™‡∏™‡∏µ‡∏Ç‡∏≠‡∏á‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
    function updateStatusButtonClass(button, status) {
    button.classList.remove('status-‡∏°‡∏≤', 'status-‡∏Ç‡∏≤‡∏î', 'status-‡∏•‡∏≤', 'status-‡∏°‡∏≤‡∏™‡∏≤‡∏¢');

    switch (status) {
        case '‚úÖ ‡∏°‡∏≤':
            button.classList.add('status-‡∏°‡∏≤');
            break;
        case '‚ùå ‡∏Ç‡∏≤‡∏î':
            button.classList.add('status-‡∏Ç‡∏≤‡∏î');
            break;
        case 'üìù ‡∏•‡∏≤':
            button.classList.add('status-‡∏•‡∏≤');
            break;
        case '‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢':
            button.classList.add('status-‡∏°‡∏≤‡∏™‡∏≤‡∏¢');
            break;
    }
}


   function exportTableToExcel() {
    const table = document.querySelector("#attendanceTable");
    const rows = table.querySelectorAll("tbody tr");

    // ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏õ ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
    const data = [["‡∏•‡∏≥‡∏î‡∏±‡∏ö", "‡∏ä‡∏∑‡πà‡∏≠ - ‡∏™‡∏Å‡∏∏‡∏•", "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞"]];

    rows.forEach(row => {
        const index = row.querySelector("td:nth-child(1)").textContent.trim();
        // ‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏∞‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å td:nth-child(2) ‡πÅ‡∏ï‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡∏ä‡∏∑‡πà‡∏≠ (div ‡∏ï‡∏±‡∏ß‡πÅ‡∏£‡∏Å)
        const nameDiv = row.querySelector("td:nth-child(2) > div:first-child");
        const name = nameDiv ? nameDiv.textContent.trim() : "";
        
        const activeStatusButton = row.querySelector(".status-option.active");
        const status = activeStatusButton ? activeStatusButton.dataset.status : "";

        data.push([index, name, status]);
    });

    const worksheet = XLSX.utils.aoa_to_sheet(data);
    const workbook = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(workbook, worksheet, "‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠ ‡∏°.3.1");

    XLSX.writeFile(workbook, "‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠ ‡∏°.3-1.xlsx");
}

    async function saveToGoogleSheet() {
        // Get reference to the loading overlay
        const loadingOverlay = document.getElementById('loadingOverlay');
        
        const table = document.querySelector("#attendanceTable");
        const rows = table.querySelectorAll("tbody tr");

        // --- ‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ---
        let allStatusesSelected = true;
        for (const row of rows) {
            const activeStatusButton = row.querySelector(".status-option.active");
            if (!activeStatusButton) {
                allStatusesSelected = false;
                break; 
            }
        }

        if (!allStatusesSelected) {
            // Show custom warning modal instead of alert (UPDATED)
            document.getElementById('warningModalOverlay').style.display = 'flex';
            return; 
        }
        // --- ‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö ---

        // ‡πÅ‡∏™‡∏î‡∏á Loading Overlay ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß
        loadingOverlay.style.display = 'flex'; 

        // **‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏î‡πâ‡∏ß‡∏¢ Web app URL ‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å Apps Script Deploy**
        const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbw48qLnuUuwliixRy-N8-jAfyg585hWQovMXrdriC3Nfvlt8u3Po2Wr13yac_1dUzX_/exec'; // ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á URL, ‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏∑‡∏°‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏à‡∏£‡∏¥‡∏á

        const dataToSave = [];
        rows.forEach(row => {
            const index = row.querySelector("td:nth-child(1)").textContent.trim();
            const nameDiv = row.querySelector("td:nth-child(2) > div:first-child");
            const name = nameDiv ? nameDiv.textContent.trim() : "";
            
            const activeStatusButton = row.querySelector(".status-option.active");
            const status = activeStatusButton ? activeStatusButton.dataset.status : "";
            
            dataToSave.push({ index, name, status }); 
        });

        try {
            const response = await fetch(WEB_APP_URL, {
                method: 'POST',
                mode: 'no-cors', 
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(dataToSave),
            });
            
            // Clear localStorage after successful save
            rows.forEach(row => {
                const studentId = row.dataset.studentId;
                localStorage.removeItem(`status_${studentId}`);
            });

            // Show custom success modal instead of alert
            document.getElementById('successModalOverlay').style.display = 'flex';

        } catch (error) {
            console.error('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:', error);
            alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•. ‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Console ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Apps Script ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì');
        } finally {
            loadingOverlay.style.display = 'none'; // ‡∏ã‡πà‡∏≠‡∏ô Loading Overlay ‡πÄ‡∏™‡∏°‡∏≠‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô
        }
    }

    async function checkAllPresentAndSave() {
        const rows = document.querySelectorAll("#attendanceTable tbody tr");
        rows.forEach(row => {
            const studentId = row.dataset.studentId;
            const presentButton = row.querySelector(".status-option[data-status='‚úÖ ‡∏°‡∏≤']");
            if (presentButton) {
                // Simulate a click on the "Present" button
                presentButton.click();
            }
        });
        // After marking all as present, save the data
        
    }
</script>

<div id="loadingOverlay">
    <div class="loading-content">
        <div class="spinner"></div>
        <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
    </div>
</div>

<div id="successModalOverlay" class="modal-overlay">
    <div class="modal-content">
        <h3>‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</h3>
        <p>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏î‡πâ‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß</p>
        <button id="successModalCloseBtn" class="modal-close-button">‡∏ï‡∏Å‡∏•‡∏á</button>
    </div>
</div>

<div id="warningModalOverlay" class="modal-overlay">
    <div class="modal-content warning-modal-content">
        <h3>‚ö†Ô∏è ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå!</h3>
        <p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ç‡∏≠‡∏á‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>
        <button id="warningModalCloseBtn" class="modal-close-button warning-modal-button">‡∏ï‡∏Å‡∏•‡∏á</button>
    </div>
</div>

</body>
</html>